#!/bin/bash

temp_file=".git/assisted_message.txt"
message_file=".git/message.txt"

PREAMBLE="#
# This commit message is auto-generated by Claude!
# Please review to make sure it is correct.
#"

echo "$PREAMBLE" > "$temp_file"

echo "Generating commit message..."
commit_message_generator.py > "$message_file"

sed "1{/^$/d;}" "$message_file" >> "$temp_file" && rm "$message_file"

git commit -F "$temp_file" >> /dev/null

rm "$temp_file"

git commit --amend
